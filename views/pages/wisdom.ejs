<div class="wisdom-container">
  <!-- Loading state -->
  <div id="loading-state" class="flex items-center justify-center" style="height: 200px;">
    <div class="spinner"></div>
  </div>

  <!-- Wisdom content -->
  <div id="wisdom-content" class="hidden">
    <!-- Wisdom Header -->
    <div class="goals-header">
      <div>
        <h1 class="text-3xl font-bold text-foreground mb-2">Wisdom Library</h1>
        <p class="text-lg text-muted-foreground">Collect and organize inspirational quotes and wisdom</p>
      </div>
      <button class="btn btn-primary" id="add-wisdom-btn">
        Add Wisdom
      </button>
    </div>
    
    <!-- Simple Dashboard Stats -->
    <div class="grid grid-cols-4 gap-6 mb-6">
      <div class="card text-center">
        <div class="card-content p-4">
          <div class="text-2xl font-bold text-primary" id="total-items">0</div>
          <div class="text-sm text-muted-foreground">Total Items</div>
        </div>
      </div>
      
      <div class="card text-center">
        <div class="card-content p-4">
          <div class="text-2xl font-bold text-success" id="favorite-count">0</div>
          <div class="text-sm text-muted-foreground">Favorites</div>
        </div>
      </div>
      
      <div class="card text-center">
        <div class="card-content p-4">
          <div class="text-2xl font-bold text-warning" id="category-count">0</div>
          <div class="text-sm text-muted-foreground">Categories</div>
        </div>
      </div>
      
      <div class="card text-center">
        <div class="card-content p-4">
          <div class="text-2xl font-bold text-primary" id="author-count">0</div>
          <div class="text-sm text-muted-foreground">Authors</div>
        </div>
      </div>
    </div>

    <!-- Wisdom Cards Grid -->
    <div id="wisdom-grid" class="grid grid-cols-2 gap-6">
      <!-- Wisdom cards will be loaded here -->
    </div>

    <!-- No Wisdom Message -->
    <div id="no-wisdom" class="flex justify-center py-12 hidden">
      <div class="bg-blue-50 border border-blue-200 rounded-xl p-8 max-w-md w-full text-center cursor-pointer hover:bg-blue-100 transition-colors duration-200" id="create-first-wisdom-card">
        <div class="mb-6">
          <svg width="48" height="48" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" class="mx-auto mb-3">
            <rect x="12" y="8" width="40" height="48" rx="4" fill="#3B82F6" stroke="#1E40AF" stroke-width="2"/>
            <rect x="16" y="16" width="32" height="2" rx="1" fill="#EFF6FF"/>
            <rect x="16" y="22" width="28" height="2" rx="1" fill="#EFF6FF"/>
            <rect x="16" y="28" width="30" height="2" rx="1" fill="#EFF6FF"/>
            <rect x="16" y="34" width="24" height="2" rx="1" fill="#EFF6FF"/>
            <circle cx="20" cy="44" r="2" fill="#EFF6FF"/>
            <rect x="26" y="42" width="18" height="4" rx="2" fill="#EFF6FF"/>
          </svg>
        </div>
        <h3 class="text-xl font-semibold text-blue-900 mb-3">Ready to Capture Wisdom?</h3>
        <p class="text-blue-700 mb-6 leading-relaxed">
          Start building your personal library of insights, quotes, and wisdom that inspire and guide you on your journey.
        </p>
        <div class="bg-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-blue-700 transition-colors duration-200">
          Create Your First Wisdom Entry
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Wisdom Creation/Edit Form (Full Page) -->
<div id="wisdom-form-page" class="wisdom-container hidden">
  <!-- Header -->
  <div class="goals-header">
    <div>
      <h1 id="form-page-title" class="text-3xl font-bold text-foreground mb-2">Add New Wisdom</h1>
      <p class="text-lg text-muted-foreground">Capture insights, quotes, and wisdom</p>
    </div>
    <div class="flex items-center gap-3">
      <button class="btn btn-secondary" id="cancel-wisdom">
        Cancel
      </button>
      <button class="btn btn-primary" id="save-wisdom">
        Save
      </button>
    </div>
  </div>

  <!-- Form Content -->
  <div class="card">
    <div class="card-content p-6">
    <form id="wisdom-form" class="space-y-6">
      <!-- Wisdom Content Editor -->
      <div>
        <div class="mb-3">
          <label class="text-sm font-semibold text-gray-700">Wisdom Content</label>
          <span class="text-red-500">*</span>
        </div>
        
        <!-- Rich Text Editor Container -->
        <div class="bg-white border border-gray-300 rounded-lg overflow-hidden shadow-sm">
          <!-- Toolbar -->
          <div class="border-b border-gray-200 px-4 py-3 bg-gray-50">
            <div class="flex items-center gap-1">
              <!-- Text Formatting -->
              <button type="button" class="toolbar-btn" data-action="bold" title="Bold">
                <span class="text-xs font-bold">B</span>
              </button>
              <button type="button" class="toolbar-btn" data-action="italic" title="Italic">
                <span class="text-xs italic">I</span>
              </button>
              <button type="button" class="toolbar-btn" data-action="underline" title="Underline">
                <span class="text-xs underline">U</span>
              </button>
              
              <div class="w-px h-6 bg-gray-300 mx-2"></div>
              
              <!-- Lists -->
              <button type="button" class="toolbar-btn" data-action="unordered-list" title="Bullet List">
                <span class="text-xs">â€¢</span>
              </button>
              <button type="button" class="toolbar-btn" data-action="ordered-list" title="Numbered List">
                <span class="text-xs">1.</span>
              </button>
              
              <div class="w-px h-6 bg-gray-300 mx-2"></div>
              
              <!-- Quote -->
              <button type="button" class="toolbar-btn" data-action="quote" title="Quote">
                <span class="text-xs">"</span>
              </button>
              
              <!-- Code -->
              <button type="button" class="toolbar-btn" data-action="code" title="Code">
                <span class="text-xs">&lt;/&gt;</span>
              </button>
              
              <div class="w-px h-6 bg-gray-300 mx-2"></div>
              
              <!-- Link -->
              <button type="button" class="toolbar-btn" data-action="link" title="Link">
                <span class="text-xs">Link</span>
              </button>
              
              <!-- Image -->
              <button type="button" class="toolbar-btn" data-action="image" title="Image">
                <span class="text-xs">Img</span>
              </button>
              
              <div class="flex-1"></div>
              
              <!-- Preview Toggle -->
              <button type="button" class="toolbar-btn" id="preview-toggle" title="Preview">
                <span class="text-xs">Preview</span>
              </button>
              
              <!-- Fullscreen -->
              <button type="button" class="toolbar-btn" id="fullscreen-toggle" title="Fullscreen">
                <span class="text-xs">Full</span>
              </button>
            </div>
          </div>
          
          <!-- Editor Area -->
          <div class="relative">
            <textarea id="wisdom-content" class="w-full h-80 p-4 border-0 resize-none focus:outline-none text-gray-800 leading-relaxed" placeholder="Start writing your wisdom content here...

You can use markdown formatting:
- **Bold text**
- *Italic text*
- > Blockquotes
- - Lists
- Links and more..." required></textarea>
            <div id="markdown-preview" class="w-full h-80 p-4 bg-white overflow-y-auto prose max-w-none hidden"></div>
          </div>
        </div>
      </div>

      <!-- Form Fields Grid -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Author -->
        <div>
          <div class="mb-3">
            <label for="wisdom-author" class="text-sm font-semibold text-gray-700">Author</label>
          </div>
          <input type="text" id="wisdom-author" class="w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white" placeholder="Who said this?">
        </div>

        <!-- Source -->
        <div>
          <div class="mb-3">
            <label for="wisdom-source" class="text-sm font-semibold text-gray-700">Source</label>
          </div>
          <input type="text" id="wisdom-source" class="w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white" placeholder="Book, article, speech, etc.">
        </div>

        <!-- Category -->
        <div>
          <div class="mb-3">
            <label for="wisdom-category" class="text-sm font-semibold text-gray-700">Category</label>
          </div>
          <input type="text" id="wisdom-category" class="w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white" placeholder="Life, Business, Philosophy, etc.">
        </div>

        <!-- Tags -->
        <div>
          <div class="mb-3">
            <label for="wisdom-tags" class="text-sm font-semibold text-gray-700">Tags</label>
          </div>
          <input type="text" id="wisdom-tags" class="w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white" placeholder="motivation, success, growth (comma separated)">
        </div>
      </div>

      <!-- Personal Notes -->
      <div>
        <div class="mb-3">
          <label for="wisdom-notes" class="text-sm font-semibold text-gray-700">Personal Notes</label>
        </div>
        <textarea id="wisdom-notes" class="w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white" rows="4" placeholder="Why is this meaningful to you? How does it apply to your life?"></textarea>
        <div class="flex items-center justify-end mt-2">
          <span class="text-xs text-gray-400" id="notes-char-count">0 characters</span>
        </div>
      </div>
    </form>
    </div>
  </div>
</div>

<style>
/* Ensure buttons are properly styled and clickable */
button {
  cursor: pointer;
  border: none;
  outline: none;
}

.toolbar-btn {
  padding: 8px;
  border: none;
  background: none;
  border-radius: 6px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.toolbar-btn:hover {
  background-color: #f3f4f6;
}

.toolbar-btn.bg-blue-100 {
  background-color: #dbeafe !important;
}

.toolbar-btn.text-blue-600 {
  color: #2563eb !important;
}

/* Ensure action buttons on cards are clickable */
[onclick] {
  cursor: pointer !important;
  pointer-events: auto !important;
}

/* Spinner styles */
.spinner {
  border: 2px solid #f3f4f6;
  border-top: 2px solid #3b82f6;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Make sure form elements are properly styled */
input, textarea {
  font-family: inherit;
}

/* Hidden class */
.hidden {
  display: none !important;
}
</style>

<script>
// Initialize wisdom page when DOM loads
document.addEventListener('DOMContentLoaded', function() {
  if (window.APP_CONFIG.currentPage === 'wisdom') {
    console.log('Wisdom page loading...');
    
    // Ensure WisdomComponent is available
    if (window.WisdomComponent) {
      console.log('WisdomComponent found, initializing...');
      window.WisdomComponent.init();
    } else {
      console.log('WisdomComponent not found, waiting...');
      // Wait for components to load
      setTimeout(() => {
        if (window.WisdomComponent) {
          console.log('WisdomComponent found after timeout, initializing...');
          window.WisdomComponent.init();
        } else {
          console.error('WisdomComponent still not found after timeout');
        }
      }, 500);
    }
  }
});

// Add click event debugging
document.addEventListener('click', function(e) {
  console.log('Clicked element:', e.target);
  console.log('Has onclick:', e.target.hasAttribute('onclick'));
  if (e.target.hasAttribute('onclick')) {
    console.log('Onclick attribute:', e.target.getAttribute('onclick'));
  }
});
</script>